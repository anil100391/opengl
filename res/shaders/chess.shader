// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
#shader vertex
#version 330 core

// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
layout(location = 0) in vec4 position;
layout(location = 1) in vec2 texCoord;

// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
uniform mat4 u_MVP;

// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
void main()
{
    gl_Position = u_MVP * position;
};

// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
#shader fragment
#version 330 core

// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
layout(location = 0) out vec4 color;

// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
uniform int u_Cell;
uniform float u_Size;
uniform vec2 u_CellOrigin;

// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
float plot( vec2 xy )
{
    return smoothstep( 0.0, 0.1, abs( fract( xy.x ) - fract( xy.y ) ) );
}

// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
bool isDarkSquare( int squareIndex )
{
    int row = squareIndex / 8;
    int col = squareIndex % 8;
    return (row % 2 == col % 2);
}

// -----------------------------------------------------------------------------
// -----------------------------------------------------------------------------
void main()
{
    if ( isDarkSquare( u_Cell ) )
    {
        vec2 coord = vec2( gl_FragCoord ) - u_CellOrigin;
        coord = coord / u_Size;
        coord += 1.0f;
        coord *= 8.0f;
        float fac = plot( coord );
        color = (1.0f - fac) * vec4( 0.7, 0.7, 0.7, 1.0f ) + fac * vec4( 0.2, 0.2, 0.2, 1.0f );
    }
    else
    {
        color = vec4( 1.0, 1.0, 1.0, 1.0f );
    }
}

